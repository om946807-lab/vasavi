<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Slip - Sri Vasavi Jewellers</title>
    <link rel="icon" href="gold.png" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lobster&family=Inter:wght@300;400;500;600;700;800&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        .store-title {
            font-family: 'Lobster', cursive;
        }

        @media print {
            body {
                margin: 0;
                padding: 0;
                background: white;
            }

            .no-print {
                display: none !important;
            }

            .print-container {
                box-shadow: none !important;
                border: none !important;
                max-width: 100% !important;
                margin: 0 !important;
            }

            body::before {
                content: "SRI VASAVI JEWELLERS";
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) rotate(-45deg);
                font-size: 4.5em;
                color: rgba(0, 0, 0, 0.08);
                white-space: nowrap;
                z-index: -1;
                font-weight: 900;
                pointer-events: none;
            }
        }

        /* Mobile Receipt Styles */
        @media (max-width: 768px) {
            .receipt-divider {
                border-top: 2px dashed #e5e7eb;
                margin: 1rem 0;
            }

            .receipt-item {
                background: linear-gradient(135deg, #f9fafb 0%, #ffffff 100%);
            }
        }

        /* Desktop Styles */
        @media (min-width: 769px) {
            .desktop-container {
                max-width: 1000px;
                margin: 2rem auto;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .btn-hover {
            transition: all 0.3s ease;
        }

        .btn-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .btn-hover:active {
            transform: scale(0.95);
        }
    </style>
</head>

<body class="bg-gradient-to-br from-gray-50 to-gray-100">
    <!-- Mobile View -->
    <div id="mobileView" class="hidden">
        <!-- Sticky Header -->
        <div
    class="no-print fixed top-0 left-0 right-0 bg-white shadow-xl z-50 px-4 py-3 flex items-center justify-between border-b-2 border-red-600">
    <h1 class="text-lg font-bold text-gray-800">ðŸ“„ Order Slip</h1>
    <div class="flex gap-2">
        <!-- Share Button -->
        <button onclick="handleShare()" class="bg-blue-500 text-white p-2.5 rounded-full shadow-lg btn-hover">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
            </svg>
        </button>

        <!-- Print Button -->
        <button onclick="handlePrint()" class="bg-green-500 text-white p-2.5 rounded-full shadow-lg btn-hover">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
            </svg>
        </button>

        <!-- Back Button -->
        <a href="view-order-slip.html"
            class="bg-gray-300 text-gray-800 p-2.5 rounded-full shadow-lg btn-hover flex items-center justify-center">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
        </a>
    </div>
</div>


        <!-- Mobile Receipt -->
        <div class="mt-16 mb-6 mx-3 bg-white rounded-2xl shadow-2xl overflow-hidden print-container fade-in">
            <!-- Header with Branding -->
            <div class="bg-gradient-to-br from-red-600 via-red-700 to-red-800 text-white px-5 py-6 relative">
                <div
                    class="absolute top-3 right-3 bg-white/20 backdrop-blur-sm px-3 py-1 rounded-full text-xs font-semibold border border-white/30">
                    ORDER SLIP
                </div>

                <!-- Diamond Icon -->
                <div
                    class="w-24 h-24 bg-white rounded-full mx-auto mb-3 flex items-center justify-center shadow-2xl overflow-hidden">
                    <img src="gold.png" alt="icon" class="w-14 h-14 object-contain">
                </div>


                <h1 class="text-2xl font-bold text-center mb-1 tracking-wider store-title">SRI VASAVI JEWELLERS</h1>
                <p class="text-xs text-center opacity-90 mb-2">||Sri Vasavi Prasanna||</p>

                <div class="text-xs text-center opacity-95 leading-relaxed space-y-1">
                    <p>Bagalkot Road, Near Police Station</p>
                    <p>Mudgal - 584125</p>
                    <p class="mt-2 font-semibold">â˜Ž 7022269436</p>
                </div>
            </div>

            <!-- Order Info -->
            <div class="px-4 py-4">
                <div class="bg-gradient-to-r from-red-50 to-orange-50 rounded-xl p-4 border-2 border-red-200 mb-4">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-xs text-gray-600 font-semibold uppercase tracking-wide">Order Number</span>
                        <span class="text-xl font-bold text-red-600" id="mobileOrderNumber">#0000</span>
                    </div>
                    <div class="h-px bg-gradient-to-r from-transparent via-red-300 to-transparent mb-3"></div>

                    <div class="space-y-2.5">
                        <div class="flex items-center gap-3">
                            <div class="bg-blue-100 p-2 rounded-lg">
                                <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs text-gray-500">Customer Name</p>
                                <p class="text-sm font-semibold text-gray-800" id="mobileCustomerName">-</p>
                            </div>
                        </div>

                        <div class="flex items-center gap-3">
                            <div class="bg-green-100 p-2 rounded-lg">
                                <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs text-gray-500">Phone Number</p>
                                <p class="text-sm font-semibold text-gray-800" id="mobileCustomerPhone">-</p>
                            </div>
                        </div>

                        <div class="flex items-center gap-3">
                            <div class="bg-purple-100 p-2 rounded-lg">
                                <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs text-gray-500">Order Date</p>
                                <p class="text-sm font-semibold text-gray-800" id="mobileOrderDate">-</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="receipt-divider"></div>

                <!-- Items Section -->
                <div class="mb-4">
                    <h2 class="text-sm font-bold text-gray-700 mb-3 uppercase tracking-wide flex items-center gap-2">
                        <svg class="w-5 h-5 text-red-600" fill="currentColor" viewBox="0 0 20 20">
                            <path
                                d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" />
                        </svg>
                        Items Ordered
                    </h2>
                    <div id="mobileItemsList" class="space-y-3">
                        <!-- Items will be inserted here -->
                    </div>
                </div>

                <div class="receipt-divider"></div>

                <!-- Payment History -->
                <div id="mobilePaymentSection" class="mb-4 hidden">
                    <h2 class="text-sm font-bold text-gray-700 mb-3 uppercase tracking-wide flex items-center gap-2">
                        <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4z" />
                            <path fill-rule="evenodd"
                                d="M18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z"
                                clip-rule="evenodd" />
                        </svg>
                        Payment History
                    </h2>
                    <div id="mobilePaymentList" class="space-y-2">
                        <!-- Payments will be inserted here -->
                    </div>
                    <div class="receipt-divider"></div>
                </div>

                <!-- Total Summary -->
                <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-4 border border-gray-200">
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600 font-medium">Total Amount</span>
                            <span class="text-lg font-bold text-gray-800" id="mobileTotalAmount">â‚¹0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600 font-medium">Advance Paid</span>
                            <span class="text-lg font-bold text-green-600" id="mobileAdvancePayment">â‚¹0</span>
                        </div>
                        <div class="h-px bg-gradient-to-r from-transparent via-gray-400 to-transparent"></div>
                        <div class="flex justify-between items-center pt-1">
                            <span class="text-base font-bold text-gray-800">Balance Due</span>
                            <span class="text-2xl font-bold text-red-600" id="mobileBalanceAmount">â‚¹0</span>
                        </div>
                    </div>
                </div>

                <!-- Amount in Words -->
                <div class="mt-4 bg-blue-50 rounded-xl p-4 border-2 border-blue-200">
                    <p class="text-xs text-gray-600 mb-1 font-semibold">Amount in Words:</p>
                    <p class="text-xs font-semibold text-blue-900 leading-relaxed" id="mobileAmountInWords">-</p>
                </div>

                <div class="receipt-divider"></div>

                <!-- Signature -->
                <div class="text-center py-4">
                    <p class="text-xs text-gray-500 mb-3">Owner's Signature</p>
                    <div class="border-t-2 border-gray-400 w-40 mx-auto mb-5"></div>
                    <p class="text-sm font-semibold text-gray-800 mb-1">Thank you for visiting!</p>
                    <p class="text-xs text-gray-600">Sri Vasavi Jewellers</p>
                </div>
            </div>

            <!-- Footer -->
            <div class="bg-gradient-to-r from-red-600 via-red-700 to-red-800 text-white text-center py-3">
                <p class="text-xs font-semibold tracking-wide">âœ¨ VISIT AGAIN âœ¨</p>
            </div>
        </div>
    </div>

    <!-- Desktop View -->
    <div id="desktopView" class="hidden">
        <!-- Header -->
        <div class="no-print bg-gradient-to-r from-blue-600 via-blue-700 to-blue-800 shadow-2xl">
    <div class="max-w-6xl mx-auto px-6 py-5 flex justify-between items-center">
        <h1 class="text-3xl font-bold text-white tracking-wide">ðŸ“„ Order Slip</h1>
        <div class="flex gap-3">
            <!-- Share Button -->
            <button onclick="handleShare()"
                class="bg-white text-blue-600 px-6 py-2.5 rounded-lg font-semibold shadow-lg btn-hover flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
                </svg>
                Share
            </button>

            <!-- Print Button -->
            <button onclick="handlePrint()"
                class="bg-orange-500 text-white px-6 py-2.5 rounded-lg font-semibold shadow-lg btn-hover flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                </svg>
                Print
            </button>

            <!-- Back Button -->
            <a href="view-order-slip.html"
                class="bg-gray-300 text-gray-800 px-6 py-2.5 rounded-lg font-semibold shadow-lg btn-hover flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M15 19l-7-7 7-7" />
                </svg>
                Back
            </a>
        </div>
    </div>
</div>


        <!-- Desktop Bill Container -->
        <div class="flex justify-center">

        <div class="desktop-container bg-white rounded-2xl shadow-2xl overflow-hidden my-8 mx-4 print-container fade-in border-2 border-gray-200">
            <!-- Header Section -->
            <div
                class="relative bg-gradient-to-br from-gray-50 to-white px-10 py-8 border-b-4 border-double border-gray-800">
                <div
                    class="absolute top-5 right-8 bg-red-100 text-red-700 px-5 py-2 rounded-lg font-bold text-sm border-2 border-red-700 shadow-lg">
                    ORDER SLIP
                </div>

                <div
                    class="absolute top-5 left-8 w-36 h-36 bg-gradient-to-br from-yellow-400 via-yellow-500 to-yellow-600 rounded-full flex items-center justify-center shadow-2xl border-4 border-white overflow-hidden">
                    <img src="gold.png" alt="icon" class="w-24 h-24 object-contain">
                </div>


                <div class="text-center ml-32">
                    <p class="text-sm text-gray-600 mb-1">||Sri Vasavi Prasanna||</p>
                    <h1 class="text-5xl font-bold text-red-700 mb-3 tracking-wide store-title">
                        SRI VASAVI JEWELLERS
                    </h1>
                    <div class="text-gray-600 text-sm leading-relaxed">
                        <p class="font-medium">Bagalkot Road, Near Police Station, Mudgal - 584125</p>
                        <p class="mt-1 font-semibold">ðŸ“ž Phone: 7022269436</p>
                    </div>
                </div>
            </div>

            <!-- Details Section -->
            <div class="px-10 py-6">
                <div
                    class="grid grid-cols-2 gap-6 border-2 border-gray-800 rounded-xl p-6 mb-6 bg-gradient-to-r from-gray-50 to-white">
                    <div class="border-r-2 border-gray-800 pr-6">
                        <h2 class="font-bold text-lg mb-3 text-gray-800 flex items-center gap-2">
                            <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4zm3 1h2v2H7V5zm2 4H7v2h2V9zm2-4h2v2h-2V5zm2 4h-2v2h2V9z"
                                    clip-rule="evenodd" />
                            </svg>
                            Store Details
                        </h2>
                        <div class="text-sm text-gray-700 space-y-1.5">
                            <p class="font-bold text-red-700">SRI VASAVI JEWELLERS</p>
                            <p>Bagalkot Road, Near Police Station</p>
                            <p>Mudgal - 584125</p>
                            <p class="font-semibold">ðŸ“ž 7022269436</p>
                        </div>
                    </div>
                    <div>
                        <h2 class="font-bold text-lg mb-3 text-gray-800 flex items-center gap-2">
                            <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                                    clip-rule="evenodd" />
                            </svg>
                            Customer Details
                        </h2>
                        <div class="text-sm space-y-1.5">
                            <p><strong>Order No:</strong> <span id="desktopOrderNumber"
                                    class="text-red-600 font-bold">-</span></p>
                            <p><strong>Name:</strong> <span id="desktopCustomerName">-</span></p>
                            <p><strong>Phone:</strong> <span id="desktopCustomerPhone">-</span></p>
                            <p><strong>Date:</strong> <span id="desktopOrderDate">-</span></p>
                        </div>
                    </div>
                </div>

                <!-- Items Table -->
                <h2 class="font-bold text-xl mb-4 text-gray-800 flex items-center gap-2">
                    <svg class="w-6 h-6 text-red-600" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                        <path fill-rule="evenodd"
                            d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z"
                            clip-rule="evenodd" />
                    </svg>
                    Bill Details
                </h2>
                <div class="overflow-hidden rounded-xl shadow-xl mb-6 border border-gray-200">
                    <table class="w-full">
                        <thead class="bg-gradient-to-r from-gray-800 to-gray-900 text-white">
                            <tr>
                                <th class="py-4 px-4 text-left text-sm font-semibold">Item Type</th>
                                <th class="py-4 px-4 text-left text-sm font-semibold">Item Name</th>
                                <th class="py-4 px-4 text-center text-sm font-semibold">Weight (gm)</th>
                                <th class="py-4 px-4 text-center text-sm font-semibold">Rate/gm</th>
                                <th class="py-4 px-4 text-center text-sm font-semibold">Making</th>
                                <th class="py-4 px-4 text-center text-sm font-semibold">Wastage</th>
                                <th class="py-4 px-4 text-right text-sm font-semibold">Total</th>
                            </tr>
                        </thead>
                        <tbody id="desktopItemsList">
                            <!-- Items will be inserted here -->
                        </tbody>
                    </table>
                </div>

                <!-- Payment and Total Section -->
                <div class="flex gap-6 items-start mb-6">
                    <!-- Payment History -->
                    <div id="desktopPaymentSection"
                        class="flex-1 bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-5 border-2 border-green-200 shadow-lg hidden">
                        <h2 class="font-bold text-lg mb-3 text-gray-800 flex items-center gap-2">
                            <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4z" />
                                <path fill-rule="evenodd"
                                    d="M18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z"
                                    clip-rule="evenodd" />
                            </svg>
                            Payment Details
                        </h2>
                        <table class="w-full">
                            <thead class="bg-green-200">
                                <tr>
                                    <th class="py-2 px-3 text-left text-sm font-semibold text-gray-800">Sub ID</th>
                                    <th class="py-2 px-3 text-center text-sm font-semibold text-gray-800">Amount</th>
                                    <th class="py-2 px-3 text-center text-sm font-semibold text-gray-800">Date</th>
                                </tr>
                            </thead>
                            <tbody id="desktopPaymentList">
                                <!-- Payments will be inserted here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Total Summary -->
                    <div
                        class="w-96 bg-gradient-to-br from-blue-50 via-blue-100 to-indigo-100 rounded-xl p-6 border-2 border-blue-300 shadow-2xl">
                        <div class="space-y-4">
                            <div class="flex justify-between items-center pb-3 border-b-2 border-blue-300">
                                <span class="font-semibold text-gray-700">Total Amount:</span>
                                <span class="text-xl font-bold text-gray-900" id="desktopTotalAmount">â‚¹0</span>
                            </div>
                            <div class="flex justify-between items-center pb-3 border-b-2 border-blue-300">
                                <span class="font-semibold text-gray-700">Advance Payment:</span>
                                <span class="text-xl font-bold text-green-600" id="desktopAdvancePayment">â‚¹0</span>
                            </div>
                            <div class="flex justify-between items-center pt-2">
                                <span class="font-bold text-gray-800 text-lg">Balance Amount:</span>
                                <span class="text-3xl font-bold text-red-600" id="desktopBalanceAmount">â‚¹0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Amount in Words -->
                <div
                    class="bg-gradient-to-r from-yellow-50 to-amber-50 border-2 border-yellow-400 rounded-xl p-5 mb-6 shadow-lg">
                    <p class="text-sm text-gray-700 mb-1 font-bold">Amount in Words:</p>
                    <p class="text-base font-semibold text-red-700" id="desktopAmountInWords">-</p>
                </div>

                <!-- Signature -->
                <div class="text-right mt-8 mb-6">
                    <p class="text-sm text-gray-600 mb-3 font-semibold">Owner's Signature</p>
                    <div class="border-t-2 border-gray-800 w-56 ml-auto"></div>
                </div>
            </div>

            <!-- Footer -->
            <div class="border-t-4 border-double border-gray-800"></div>
            <div class="text-center py-5 bg-gradient-to-r from-gray-50 to-gray-100">
                <p class="text-lg font-bold text-gray-800">Thank you for visiting Vasavi Jewellers!</p>
                <p class="text-sm text-gray-600 mt-1">âœ¨ Visit Again âœ¨</p>
            </div>
        </div>
    </div>
    </>

    <script>
        let orderData = null;
        let paymentHistory = [];

        function formatDate(dateString) {
            const date = new Date(dateString);
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}-${month}-${year}`;
        }

        function formatNumber(num) {
            return new Intl.NumberFormat('en-IN').format(num);
        }

        function convertNumberToWords(amount) {
            const ones = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine',
                'Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen',
                'Seventeen', 'Eighteen', 'Nineteen'];
            const tens = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
            const scales = ['', 'Thousand', 'Lakh', 'Crore'];

            function convertChunk(number) {
                let words = '';
                const hundred = Math.floor(number / 100);
                number %= 100;
                const ten = Math.floor(number / 10);
                const one = number % 10;

                if (hundred) words += ones[hundred] + ' Hundred ';
                if (ten > 1) {
                    words += tens[ten] + ' ';
                    if (one) words += ones[one] + ' ';
                } else if (ten === 1) {
                    words += ones[number] + ' ';
                } else if (one) {
                    words += ones[one] + ' ';
                }
                return words.trim();
            }

            if (amount === 0) return 'Zero';

            let words = '';
            let scaleIndex = 0;

            while (amount > 0) {
                let chunk = scaleIndex === 0 ? amount % 1000 : amount % 100;
                if (chunk > 0) words = convertChunk(chunk) + ' ' + scales[scaleIndex] + ' ' + words;
                amount = Math.floor(amount / (scaleIndex === 0 ? 1000 : 100));
                scaleIndex++;
            }

            return words.trim() + ' Only';
        }

        function checkDevice() {
            const isMobile = window.innerWidth <= 768;
            document.getElementById('mobileView').classList.toggle('hidden', !isMobile);
            document.getElementById('desktopView').classList.toggle('hidden', isMobile);
        }

        async function fetchPaymentHistory(orderId) {
            try {
                const res = await fetch(`/get-advance-history/${orderId}`);
                paymentHistory = await res.json();
                renderPayments();
            } catch (error) {
                console.error('Failed to load payment history:', error);
            }
        }

        function renderPayments() {
            const hasPay = paymentHistory && paymentHistory.length > 0;

            // Mobile
            const mobileSection = document.getElementById('mobilePaymentSection');
            const mobileList = document.getElementById('mobilePaymentList');

            if (hasPay) {
                mobileSection.classList.remove('hidden');
                mobileList.innerHTML = paymentHistory.map(payment => `
                    <div class="flex justify-between items-center bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-3 border-2 border-green-200 shadow">
                        <div>
                            <p class="text-xs text-gray-600 font-semibold">${payment.sub_id}</p>
                            <p class="text-xs text-gray-500 mt-0.5">${formatDate(payment.date)}</p>
                        </div>
                        <p class="text-base font-bold text-green-600">â‚¹${formatNumber(payment.amount.toFixed(2))}</p>
                    </div>
                `).join('');
            } else {
                mobileSection.classList.add('hidden');
            }

            // Desktop
            const desktopSection = document.getElementById('desktopPaymentSection');
            const desktopList = document.getElementById('desktopPaymentList');

            if (hasPay) {
                desktopSection.classList.remove('hidden');
                desktopList.innerHTML = paymentHistory.map((payment, index) => `
                    <tr class="border-b border-green-200 ${index % 2 === 0 ? 'bg-white' : 'bg-green-50'}">
                        <td class="py-2 px-3 text-sm font-semibold text-gray-800">${payment.sub_id}</td>
                        <td class="py-2 px-3 text-center text-sm font-bold text-green-600">â‚¹${formatNumber(payment.amount.toFixed(2))}</td>
                        <td class="py-2 px-3 text-center text-sm text-gray-700">${formatDate(payment.date)}</td>
                    </tr>
                `).join('');
            } else {
                desktopSection.classList.add('hidden');
            }
        }

        function renderOrderData() {
            if (!orderData) return;

            const orderNum = new URLSearchParams(window.location.search).get('orderNumber') || orderData.order_number;

            // Mobile
            document.getElementById('mobileOrderNumber').textContent = '#' + orderNum;
            document.getElementById('mobileCustomerName').textContent = orderData.customer_name;
            document.getElementById('mobileCustomerPhone').textContent = orderData.customer_phone;
            document.getElementById('mobileOrderDate').textContent = formatDate(orderData.order_date);

            const mobileItemsList = document.getElementById('mobileItemsList');
            mobileItemsList.innerHTML = orderData.items.map((item, index) => `
                <div class="receipt-item rounded-xl p-4 border-2 border-gray-200 shadow-md">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h3 class="font-bold text-gray-900 text-base">${item.item_name}</h3>
                            ${item.item_description ? `<p class="text-xs text-gray-500 mt-0.5">${item.item_description}</p>` : ''}
                            <p class="text-xs text-blue-600 mt-1 font-semibold">ðŸ“¦ ${item.item_type}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-xl font-bold text-red-600">â‚¹${formatNumber(item.total_amount.toFixed(2))}</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 text-xs text-gray-700 pt-3 border-t border-gray-300">
                        <div class="bg-blue-50 p-2 rounded">
                            <span class="text-gray-600">Weight:</span>
                            <strong class="block text-sm text-gray-900">${item.quantity.toFixed(2)}g</strong>
                        </div>
                        <div class="bg-purple-50 p-2 rounded">
                            <span class="text-gray-600">Rate:</span>
                            <strong class="block text-sm text-gray-900">â‚¹${formatNumber(item.amount_per_gram)}/g</strong>
                        </div>
                        <div class="bg-green-50 p-2 rounded">
                            <span class="text-gray-600">Making:</span>
                            <strong class="block text-sm text-gray-900">â‚¹${formatNumber(item.making_charges)}</strong>
                        </div>
                        <div class="bg-yellow-50 p-2 rounded">
                            <span class="text-gray-600">Wastage:</span>
                            <strong class="block text-sm text-gray-900">${item.wastage}%</strong>
                        </div>
                    </div>
                </div>
            `).join('');

            document.getElementById('mobileTotalAmount').textContent = 'â‚¹' + formatNumber(orderData.subtotal.toFixed(2));
            document.getElementById('mobileAdvancePayment').textContent = 'â‚¹' + formatNumber(orderData.advance_payment.toFixed(2));
            document.getElementById('mobileBalanceAmount').textContent = 'â‚¹' + formatNumber(orderData.balance_amount.toFixed(2));
            document.getElementById('mobileAmountInWords').textContent = convertNumberToWords(orderData.subtotal);

            // Desktop
            document.getElementById('desktopOrderNumber').textContent = '#' + orderNum;
            document.getElementById('desktopCustomerName').textContent = orderData.customer_name;
            document.getElementById('desktopCustomerPhone').textContent = orderData.customer_phone;
            document.getElementById('desktopOrderDate').textContent = formatDate(orderData.order_date);

            const desktopItemsList = document.getElementById('desktopItemsList');
            desktopItemsList.innerHTML = orderData.items.map((item, index) => `
                <tr class="border-b border-gray-200 hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 transition-colors ${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}">
                    <td class="py-3 px-4 text-sm font-semibold text-gray-800">${item.item_type}</td>
                    <td class="py-3 px-4 text-sm">
                        <span class="font-semibold text-gray-900">${item.item_name}</span>
                        ${item.item_description ? `<span class="text-gray-500"> - ${item.item_description}</span>` : ''}
                    </td>
                    <td class="py-3 px-4 text-center text-sm font-medium">${item.quantity.toFixed(2)}</td>
                    <td class="py-3 px-4 text-center text-sm font-medium">â‚¹${formatNumber(item.amount_per_gram)}</td>
                    <td class="py-3 px-4 text-center text-sm font-medium">â‚¹${formatNumber(item.making_charges)}</td>
                    <td class="py-3 px-4 text-center text-sm font-medium">${item.wastage}%</td>
                    <td class="py-3 px-4 text-right text-sm font-bold text-red-600">â‚¹${formatNumber(item.total_amount.toFixed(2))}</td>
                </tr>
            `).join('');

            document.getElementById('desktopTotalAmount').textContent = 'â‚¹' + formatNumber(orderData.subtotal.toFixed(2));
            document.getElementById('desktopAdvancePayment').textContent = 'â‚¹' + formatNumber(orderData.advance_payment.toFixed(2));
            document.getElementById('desktopBalanceAmount').textContent = 'â‚¹' + formatNumber(orderData.balance_amount.toFixed(2));
            document.getElementById('desktopAmountInWords').textContent = convertNumberToWords(orderData.subtotal);
        }

        async function loadOrderData() {
            const orderNumber = new URLSearchParams(window.location.search).get('orderNumber');
            if (!orderNumber) {
                alert('No order number found in URL');
                return;
            }

            try {
                const response = await fetch(`/fetch-order/${orderNumber}`);
                if (response.ok) {
                    orderData = await response.json();
                    renderOrderData();
                    await fetchPaymentHistory(orderNumber);
                } else {
                    alert('Failed to fetch order details');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Error loading order data');
            }
        }

        function handlePrint() {
            window.print();
        }

        async function handleShare() {
            const button = event.target.closest('button');
            const originalText = button.innerHTML;

            // Show loading state
            button.disabled = true;
            button.innerHTML = button.classList.contains('mobile-btn')
                ? '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle></svg>Loading...'
                : 'Generating PDF...';

            try {
                const element = document.getElementById('bill-content');
                const billNumber = document.getElementById('orderNumber').textContent.trim();

                const opt = {
                    margin: [10, 10, 10, 10],
                    filename: `Bill_${orderId || 'Invoice'}.pdf`,
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: {
                        scale: 2,
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#ffffff'
                    },
                    jsPDF: {
                        unit: 'mm',
                        format: 'a4',
                        orientation: 'portrait'
                    }
                };

                // Generate PDF
                const pdf = await html2pdf().set(opt).from(element).toPdf().get('pdf');
                const pdfBlob = pdf.output('blob');

                // Check if Web Share API is available
                if (navigator.share && navigator.canShare) {
                    const file = new File([pdfBlob], opt.filename, { type: 'application/pdf' });

                    if (navigator.canShare({ files: [file] })) {
                        try {
                            await navigator.share({
                                title: `Bill ${billNumber}`,
                                text: 'Sri Vasavi Jewellers - Bill',
                                files: [file]
                            });
                            console.log('PDF shared successfully');
                        } catch (shareError) {
                            if (shareError.name !== 'AbortError') {
                                console.log('Share cancelled or failed, downloading instead');
                                downloadPDF(pdfBlob, opt.filename);
                            }
                        }
                    } else {
                        // Fallback to download if file sharing not supported
                        downloadPDF(pdfBlob, opt.filename);
                    }
                } else {
                    // Fallback to download if Web Share API not available
                    downloadPDF(pdfBlob, opt.filename);
                }
            } catch (error) {
                console.error('Error generating PDF:', error);
                alert('Error generating PDF. Please try again.');
            } finally {
                // Restore button state
                button.disabled = false;
                button.innerHTML = originalText;
            }
        }

        window.addEventListener('load', () => {
            checkDevice();
            loadOrderData();
        });

        window.addEventListener('resize', checkDevice);
    </script>
</body>

</html>